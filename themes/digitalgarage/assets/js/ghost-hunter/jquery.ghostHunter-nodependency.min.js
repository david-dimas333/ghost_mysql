!function(t){var e=require("./lunr.min.js");t.fn.ghostHunter=function(e){var i=t.extend({},t.fn.ghostHunter.defaults,e);return i.results?(n.init(this,i),n):void 0},t.fn.ghostHunter.defaults={results:!1,onKeyUp:!1,result_template:"<a href='{{link}}'><p><h2>{{title}}</h2><h4>{{prettyPubDate}}</h4></p></a>",info_template:"<p>Number of posts found: {{amount}}</p>",displaySearchInfo:!0,zeroResultsInfo:!0,before:!1,onComplete:!1};var i=function(t){var e=new Date(t),i=["January","February","March","April","May","June","July","August","September","October","November","December"];return e.getDate()+" "+i[e.getMonth()]+" "+e.getFullYear()},n={isInit:!1,init:function(t,i){var n=this;this.target=t,this.results=i.results,this.blogData={},this.result_template=i.result_template,this.info_template=i.info_template,this.zeroResultsInfo=i.zeroResultsInfo,this.displaySearchInfo=i.displaySearchInfo,this.before=i.before,this.onComplete=i.onComplete,this.index=e(function(){this.field("title",{boost:10}),this.field("description"),this.field("link"),this.field("markdown",{boost:5}),this.field("pubDate"),this.field("tag"),this.ref("id")}),t.focus(function(){n.loadAPI()}),t.closest("form").submit(function(e){e.preventDefault(),n.find(t.val())}),i.onKeyUp&&(n.loadAPI(),t.keyup(function(){n.find(t.val())}))},loadAPI:function(){if(this.isInit)return!1;var e=this.index,n=this.blogData;t.get(ghost.url.api("posts",{limit:"all",include:"tags"})).done(function(t){searchData=t.posts,searchData.forEach(function(t){var r=t.tags.map(function(t){return t.name}),s=r.join(", ");s.length<1&&(s="undefined");var a={id:String(t.id),title:String(t.title),description:String(t.meta_description),markdown:String(t.markdown),pubDate:String(t.created_at),tag:s,link:String(t.url)};a.prettyPubDate=i(a.pubDate);var o=i(a.pubDate);e.add(a),n[t.id]={title:t.title,description:t.meta_description,pubDate:o,link:t.url}})}),this.isInit=!0},find:function(e){var i=this.index.search(e),n=t(this.results),r=[];n.empty(),this.before&&this.before(),(this.zeroResultsInfo||i.length>0)&&this.displaySearchInfo&&n.append(this.format(this.info_template,{amount:i.length}));for(var s=0;s<i.length;s++){var a=i[s].ref,o=this.blogData[a];n.append(this.format(this.result_template,o)),r.push(o)}this.onComplete&&this.onComplete(r)},clear:function(){t(this.results).empty(),this.target.val("")},format:function(t,e){return t.replace(/{{([^{}]*)}}/g,function(t,i){var n=e[i];return"string"==typeof n||"number"==typeof n?n:t})}}}(jQuery);